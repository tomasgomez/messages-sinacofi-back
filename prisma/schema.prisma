// prisma/schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = "postgresql://sinacofi:hola123@34.135.68.241:5432/message"
}

model CUK {
  id                     String  @id @default(uuid())
  name                   String?
  cukCode                String? @unique
  description            String?
  status                 String?
  creationDate           String?
  foreclosureDate        String?
  channel                String?
  clientDni              String?
  clientName             String?
  institutionDestination String?

  messages Message[] @relation(name: "CukMessages")
}

model Message {
  id           String  @id @default(uuid())
  TSN          Int?    @unique @default(autoincrement()) //TODO: Check correlation with NSE, OSN, etc.
  OSN          Int?    @unique @default(autoincrement())
  NSE          Int?    @unique @default(autoincrement())
  LSN          Int?    @unique @default(autoincrement())
  NSR          Int?    @unique @default(autoincrement())
  messageCode  String?
  description  String?
  priority     String?
  status       String?
  sender       String?
  creationDate String?
  creationTime String?
  receiver     String?
  receivedDate String?
  receivedTime String?
  documents    String?
  actions      String?
  parameters   Json?
  cukCode      String?
  cuk          CUK?    @relation(fields: [cukCode], references: [cukCode], name: "CukMessages")
}

model Family {
  id           Int      @id @default(autoincrement())
  name         String   @unique @db.VarChar(255)
  institutions String[]
}

model MessageFamily {
  messageId  Int
  familyId   Int
  assignedAt DateTime @default(now())

  @@id([messageId, familyId])
}
